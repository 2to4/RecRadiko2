# RecRadiko2 開発ワークフロー

## テスト駆動開発（TDD）手順
t_wadaのテスト駆動開発定義に従い、以下の手順を厳守：

1. **テストリスト作成**: 網羅したいテストシナリオのリストを書く
2. **Red（失敗）**: テストリストから「ひとつだけ」選び出し、実際に、具体的で、実行可能なテストコードに翻訳し、テストが失敗することを確認する
3. **Green（成功）**: プロダクトコードを変更し、いま書いたテスト（と、それまでに書いたすべてのテスト）を成功させる（その過程で気づいたことはテストリストに追加する）
4. **Refactor（改善）**: 必要に応じてリファクタリングを行い、実装の設計を改善する
5. **Repeat（繰り返し）**: テストリストが空になるまでステップ2に戻って繰り返す

## 必須開発手順
1. **コード変更前**: 既存テストが全て成功していることを確認
   ```bash
   xcodebuild test -project RecRadiko2.xcodeproj -scheme RecRadiko2 -destination 'platform=macOS'
   ```

2. **新機能実装時**: TDD手法でテストケース先行作成・実装

3. **コード変更後**: 必ずテスト実行・成功確認

4. **テスト失敗時**: 新しいコードはコミット・使用禁止

5. **コミット時**: 必ず日本語でコミットメッセージを記述

## 外部API連携開発
1. 先行テスト実装: 外部API連携前に独立したテストスクリプト作成
2. 設定統一: テストスクリプトと本実装で完全同一の設定使用
3. 認証フロー検証: auth1→auth2の段階的認証を個別に確認
4. エラーハンドリング: 各APIレスポンスで適切なエラー処理実装
5. ログ出力: 認証・API呼び出しの詳細ログを必ず実装

## macOSアプリ権限設定
1. entitlements確認: 新機能実装前に必要な権限を事前確認
2. ネットワーク権限: HTTP通信使用時は必ずネットワーク権限を追加
3. サンドボックス対応: ファイルアクセス・ネットワークアクセスの権限設定確認
4. 権限テスト: 権限変更後は必ずクリーンビルド・実機テスト実施

## デバッグ・トラブルシューティング
1. 段階的確認: Mock→独立テスト→実装の順で動作確認
2. ログ出力: 認証トークン・API URL・レスポンスの詳細ログ
3. 比較検証: 動作するテストコードと実装の設定比較
4. 権限確認: ネットワークエラー時はentitlements権限を最優先確認
5. ビルド確認: エラー解決後は必ずクリーンビルド実行